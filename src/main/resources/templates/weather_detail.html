<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>å¤©æ°—ã¨è²©å£²è©³ç´°</title>
    <link rel="stylesheet" th:href="@{/weather.css}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<header>
    <h1 th:text="'ğŸ“… ' + ${detail.date} + ' ã®å¤©æ°—ã¨å£²ä¸Šè©³ç´°'">å¤©æ°—ã¨å£²ä¸Šè©³ç´°</h1>
</header>

<main>
    <!-- å¤©æ°—æƒ…å ± -->
    <section class="info-box">
        <p th:text="'ğŸŒ¤ï¸ å¤©æ°—ï¼š' + (${detail.weather} ?: 'ä¸æ˜')">å¤©æ°—æƒ…å ±</p>
        <p th:if="${detail.water != null}" th:text="'ğŸŒ§ï¸ é™æ°´é‡ï¼š' + ${detail.water} + ' mm'">é™æ°´é‡</p>
        <p th:if="${detail.wind != null}" th:text="'ğŸ’¨ é¢¨é€Ÿï¼š' + ${detail.wind} + ' m/s'">é¢¨é€Ÿ</p>
        <p th:if="${detail.temperature != null}" th:text="'ğŸŒ¡ï¸ æ°—æ¸©ï¼š' + ${detail.temperature} + ' â„ƒ'">æ°—æ¸©</p>
    </section>

    <!-- å£²ä¸Šã‚°ãƒ©ãƒ• -->
    <div class="chart-container">
        <canvas id="salesChart"></canvas>
    </div>

    <!-- åœ¨åº«æƒ…å ± -->
    <section class="info-box">
        <h2 th:text="'ğŸ“¦ è£½å“åˆ¥ åœ¨åº«çŠ¶æ³ï¼ˆ' + ${detail.date} + ' æ™‚ç‚¹ï¼‰'">åœ¨åº«çŠ¶æ³</h2>
        <table>
            <thead>
                <tr>
                    <th>å•†å“å</th>
                    <th>åœ¨åº«æ•°</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="entry : ${detail.productStock.entrySet()}">
                    <td th:text="${entry.key}">å•†å“å</td>
                    <td th:text="${entry.value}">åœ¨åº«æ•°</td>
                </tr>
            </tbody>
        </table>
    </section>

    <!-- æˆ»ã‚‹ãƒœã‚¿ãƒ³ -->
    <div class="back-container">
         <!-- ç®¡ç†è€…ã®å ´åˆ -->
        <a th:if="${source == 'admin'}" th:href="@{/weather/admin-list}" class="back-button">æˆ»ã‚‹</a>

        <!-- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å ´åˆ -->
        <a th:if="${source == 'user'}" th:href="@{/weather/user-list}" class="back-button">æˆ»ã‚‹</a>
    </div>
</main>

<!-- å£²ä¸Šã‚°ãƒ©ãƒ•ã‚¹ã‚¯ãƒªãƒ—ãƒˆ -->
<script th:inline="javascript">
    const labels = [[${detail.productSales != null ? detail.productSales.keySet() : {}}]];
    const data = [[${detail.productSales != null ? detail.productSales.values() : {}}]];

    const ctx = document.getElementById('salesChart').getContext('2d');
    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [{
                label: 'è²©å£²æœ¬æ•°',
                data: data,
                backgroundColor: 'rgba(255, 215, 0, 0.7)',
                borderColor: 'rgba(255, 215, 0, 1)',
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: { stepSize: 1 }
                }
            }
        }
    });
</script>
</body>
</html>


